CRM / PRD � ESCRIT�RIO DO CONSULTOR (RS PR�LIPSI)
Documento relacional e t�cnico-funcional do m�dulo Escrit�rio do Consultor RS Pr�lipsi. Baseado na estrutura real do c�digo (Rs Pr�lipsi Consultor.zip), descreve todas as camadas operacionais, integra��es, �rvore SIGME, WalletPay, Marketplace, RS Studio e Configura��es Gerais, com foco em rastreabilidade total de dados.
1. Objetivo e Escopo

O m�dulo Escrit�rio do Consultor � o ambiente digital central de cada consultor dentro do ecossistema RS Pr�lipsi.
Integra as opera��es com SIGMA, WalletPay, Marketplace, RS Studio e Configura��es Globais.
Garante controle da rede, visualiza��o da �rvore geneal�gica SIGME, acompanhamento financeiro e acesso a recursos de marketing e comunica��o.

2. Estrutura T�cnica e L�gica do Sistema

Ambiente: React + Vite + Supabase Auth
Banco: PostgreSQL (Supabase)
Autentica��o: JWT + Roles (consultant, admin, support)
Estilo: Tailwind + Shadcn/UI
Deploy: VPS Hostinger, Porta 5002
Dom�nio: escritorio.rsprolipsi.com.br
Integra��es: SIGMA, WalletPay, Marketplace, RS Studio e Configura��es Globais

3. Estrutura de Pastas (ZIP original)

/src
  /components
    /dashboard
    /network
    /wallet
    /store
    /communication
    /profile
  /pages
    index.jsx
    network.jsx
    wallet.jsx
    store.jsx
    communication.jsx
    profile.jsx
    support.jsx
  /services
    api.js
    sigma.js
    wallet.js
    market.js
    rsstudio.js
  /hooks
  /utils
  /config
  /styles
.env

4. Dashboard Principal

Objetivo: vis�o consolidada da opera��o do consultor.
Elementos:
- Saldo Atual (WalletPay)
- Pontos Acumulados (SIGME)
- Matrizes Ativas
- Ciclos Conclu�dos
- Gr�fico de desempenho semanal
- Bot�o �Sincronizar Dados� (executa syncNetworkTree)

5. M�dulo SIGME / �rvore Geneal�gica

Componente: NetworkTree.jsx
Biblioteca: D3.js (SVG Din�mico)
Renderiza��o: baseada em coordenadas X/Y pr�-calculadas via backend Supabase.

Regras:
- Raiz: consultor autenticado.
- Cada n� representa membro ativo (tabela network_nodes).
- Campos: id, nome, n�vel, ativo, posi��o, status_ciclo, diretos.
- Cores: verde (ativo), cinza (inativo), dourado (PIN).
Interatividade:
- Zoom/pan, expans�o de n�veis, tooltip com dados.
- Atualiza��o via fun��o syncNetworkTree().

Fonte de dados: network_nodes, matrix_cycles, bonus_ledger.

6. M�dulo Financeiro / WalletPay

Fun��es:
- Exibir saldo total e ganhos mensais
- Hist�rico de b�nus (fidelidade, profundidade, ciclo)
- Solicitar saque via PIX
- Webhook de concilia��o
Endpoints:
- GET /wallet/balance
- GET /wallet/transactions
- POST /wallet/withdraw
- POST /wallet/webhook

7. M�dulo Marketplace / Loja

P�gina: /pages/store.jsx
Link de afiliado: https://loja.rsprolipsi.com.br/?ref={consultant_id}
Recursos:
- Cat�logo, estoque e comiss�o
- Integra��o market.js
- Registro autom�tico de vendas e comiss�es

8. M�dulo Comunica��o / RS Studio

Central de comunica��o e treinamento.
Fun��es:
- Chat RSA (IA)
- Painel de treinamentos e mensagens autom�ticas
- Notifica��es corporativas
Tabelas: studio_messages, trainings_progress

9. Perfil e Configura��es

P�gina: /pages/profile.jsx
Fun��es:
- Edi��o de nome, CPF/CNPJ, email, telefone
- Upload de documentos (KYC)
- Altera��o de senha / 2FA
- Atualiza��o de plano (WalletPay + Config)
Campos: user_role, plan_level, is_verified, wallet_linked

10. Banco de Dados e Rela��es Principais

Tabela | Fun��o
--------|---------
consultants | Cadastro base
network_nodes | Estrutura da rede
matrix_cycles | Controle de ciclos
bonus_ledger | Hist�rico de b�nus
wallet_accounts | Carteiras do consultor
wallet_transactions | Extratos financeiros
orders | Vendas
studio_messages | Comunica��o
trainings_progress | Treinamentos
audit_logs | Logs do sistema

11. Seguran�a e Auditoria

- JWT + Supabase Auth
- Logs de IP e dispositivo
- Criptografia AES para PIX e dados sens�veis
- Auditoria autom�tica em audit_logs
- Conformidade LGPD total

12. KPIs e Indicadores

Indicador | Fonte | Descri��o
-----------|--------|-----------
Pontos pessoais | SIGMA | Pontos do pr�prio consumo
Pontos de equipe | SIGMA | Volume gerado pela rede
Ganhos totais | WalletPay | Soma dos b�nus
Ciclos ativos | SIGMA | Matrizes em andamento
Saques processados | WalletPay | Retiradas confirmadas
Taxa de engajamento | RS Studio | Mensagens/v�deos conclu�dos

13. Triggers e Processos Autom�ticos

Trigger | A��o | Origem | Destino
----------|------|--------|----------
trg_bonus_on_cycle_complete | Gera lan�amentos de b�nus | SIGMA | WalletPay
trg_wallet_on_bonus_credit | Atualiza saldo | SIGMA | Wallet
trg_commission_on_order_paid | Registra comiss�o | Marketplace | Wallet
trg_tree_on_new_registration | Atualiza �rvore | SIGMA | Consultor

14. Seguran�a de Rede e Perfis

RLS ativa em todas as tabelas.
Consultores acessam apenas seus dados e rede direta.
Admins regionais t�m escopo parcial.
Backups autom�ticos e restore seletivo.

15. Roadmap T�cnico

Fase | Entrega | Descri��o
------|----------|-----------
F1 | SIGMA + �rvore | N�cleo de rede funcional
F2 | Financeiro | WalletPay completo
F3 | Comunica��o | Chat RSA e treinamentos
F4 | Marketplace Premium | Loja personaliz�vel
F5 | RS.IA | Intelig�ncia e relat�rios autom�ticos
